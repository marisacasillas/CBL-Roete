xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "black", lty = "solid") +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore, group = child,
linetype = child, colour = child)) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
# geom_line(data = age.local.corr.effect,
#             aes(x = age, y = fit),
#           color = "black", lty = "solid") +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
# geom_line(data = age.local.corr.effect,
#             aes(x = age, y = fit),
#           color = "black", lty = "solid") +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "black", lty = "solid") +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "black", lty = "gray60", lwd = 2) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "black", lty = "gray60", size = 2) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1) +
geom_line(aes(linetype = child, colour = child), size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
plot1.local.data
ggplot(
plot1.local.data, aes(x=age, y = averagescore)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1) +
geom_line(aes(linetype = child, colour = child), size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = NA) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
# geom_line(data = age.local.corr.effect,
#             aes(x = age, y = fit),
#           color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = NA) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
# geom_ribbon(data = age.local.corr.effect,
#             aes(x = age, ymin = lower, ymax = upper),
#             color = "gray60", alpha = 0.3) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.3) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.3, lty = NA) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.3, lty = NA) +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.3, lty = "dashed") +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.local.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.local.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.local.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = "dashed") +
geom_line(size = 1.5) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Local sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
age.cumu.corr.effect <- as.data.frame(Effect(
"recentered_age", model_cumu_corrected)) %>%
mutate(age = recentered_age + 2.5)
plot1.cumu.data <- aggregate(
subset.cumu.data$correctedscore,
by = c(list(child = subset.cumu.data$child),
list(age=subset.cumu.data$age)),
FUN = sum)
colnames(plot1.cumu.data)[3] <- "total_score"
plot1.cumu.data.temp <- aggregate(
subset.cumu.data$correctedscore,
by = c(list(child = subset.cumu.data$child),
list(age = subset.cumu.data$age)),
FUN = function(x){NROW(x)})
colnames(plot1.cumu.data.temp)[3] <- "total_num_utterances"
plot1.cumu.data <- merge(
plot1.cumu.data, plot1.cumu.data.temp,
by = c("child","age"))
plot1.cumu.data$averagescore <- plot1.cumu.data$total_score/
plot1.cumu.data$total_num_utterances
# add model-estimated age effect to plot
age.cumu.corr.effect <- as.data.frame(Effect(
"recentered_age", model_cumu_corrected)) %>%
mutate(age = recentered_age + 2.5)
ggplot(
plot1.cumu.data,
aes(x=age, y = averagescore, group = child,
linetype = child, colour = child)) +
geom_line(data = age.cumu.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.cumu.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = "dashed") +
geom_line(size = 1.5) +
#scale_colour_manual(name = "Child:", values = groupcolours) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Cumulative sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.cumu.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.cumu.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.cumu.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = "dashed") +
geom_line(size = 1.5) +
#scale_colour_manual(name = "Child:", values = groupcolours) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Cumulative sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
corrreconstruction.bysample
plot1.local.data$Sample <- "Local"
plot1.cumu.data$Sample <- "Cumulative"
corrreconstruction.data <- bind_rows(plot1.local.data, plot1.cumu.data)
corrreconstruction.data$Sample <- as.factor(corrreconstruction.data$Sample)
corrreconstruction.data$Sample <- factor(corrreconstruction.data$Sample,
levels = c("Local", "Cumulative"))
corrreconstruction.data$Child <- corrreconstruction.data$child
table(corrreconstruction.data$Sample)
age.local.corr.effect$Sample <- "Local"
age.cumu.corr.effect$Sample <- "Cumulative"
age.local.corr.effect
age.combo.corr.effect <- bind_rows(age.local.corr.effect, age.cumu.corr.effect)
ggplot(
aes(x=age, y = averagescore,
linetype = Child, colour = Child),
data = corrreconstruction.data) +
geom_line(data = age.combo.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.combo.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = "dashed") +
geom_hline(yintercept=0) +
geom_line() +
coord_cartesian(ylim=(c(-0.5,0.5))) +
facet_grid(~ Sample) +
xlab("Age (years)") +
ylab("Average reconstruction \nscore\n") +
basic.theme +
theme(
legend.key.size = unit(0.5, "cm"),
legend.key.height = unit(0.2, "cm"))
ggplot(
aes(x=age, y = averagescore,
linetype = Child, colour = Child),
data = corrreconstruction.data) +
geom_line(data = age.combo.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 1.5) +
geom_ribbon(data = age.combo.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = "dashed") +
geom_hline(yintercept=0) +
geom_line() +
coord_cartesian(ylim=(c(-0.5,0.5))) +
facet_grid(~ Sample) +
xlab("Age (years)") +
ylab("Average reconstruction \nscore\n") +
basic.theme +
theme(
legend.key.size = unit(0.5, "cm"),
legend.key.height = unit(0.2, "cm"))
ggplot(
plot1.cumu.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.cumu.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.cumu.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.1, lty = "blank") +
geom_line(size = 1.5) +
#scale_colour_manual(name = "Child:", values = groupcolours) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Cumulative sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
plot1.cumu.data,
aes(x=age, y = averagescore,
linetype = child, colour = child)) +
geom_line(data = age.cumu.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 2) +
geom_ribbon(data = age.cumu.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.2, lty = "blank") +
geom_line(size = 1.5) +
#scale_colour_manual(name = "Child:", values = groupcolours) +
coord_cartesian(ylim=(c(-0.5,0.5))) +
xlab("\nAge (years)") +
ylab("Average reconstruction \nscore\n") +
ggtitle("Cumulative sampling") +
geom_hline(yintercept=0) +
basic.theme +
theme(axis.text.x = element_text(size=10)) +
theme(plot.title = element_text(size=10, face = "bold.italic",
hjust = 0.5, margin=margin(b = 30, unit = "pt")))
ggplot(
aes(x=age, y = averagescore,
linetype = Child, colour = Child),
data = corrreconstruction.data) +
geom_line(data = age.combo.corr.effect,
aes(x = age, y = fit),
color = "gray60", lty = "solid", lwd = 1.5) +
geom_ribbon(data = age.combo.corr.effect,
aes(x = age, y = fit, ymin = lower, ymax = upper),
color = "gray60", alpha = 0.2, lty = "blank") +
geom_hline(yintercept=0) +
geom_line() +
coord_cartesian(ylim=(c(-0.5,0.5))) +
facet_grid(~ Sample) +
xlab("Age (years)") +
ylab("Average reconstruction \nscore\n") +
basic.theme +
theme(
legend.key.size = unit(0.5, "cm"),
legend.key.height = unit(0.2, "cm"))
